

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="刻苦学习逆向的小菜鸡。">
  <meta name="author" content="丨S1lenc3丨">
  <meta name="keywords" content="">
  
  <title>高校战役CTF部分writeup - S1lenc3的辣鸡场</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"www.s1lenc3.com","root":"/","version":"1.8.11","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="S1lenc3的辣鸡场" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>S1lenc3</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="高校战役CTF部分writeup">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-03-11 15:05" pubdate>
        2020年3月11日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.3k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      51
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">高校战役CTF部分writeup</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2020年3月20日 晚上
                
              </p>
            
            <div class="markdown-body">
              <h1 id="废话"><a href="#废话" class="headerlink" title="废话"></a>废话</h1><p>打了两天的比赛，小做了几道题，不可谓不充实。虽然找不到工作，也要继续学习。</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="简单的misc"><a href="#简单的misc" class="headerlink" title="简单的misc"></a>简单的misc</h2><p>用010editor打开photo.jpg，在最底部看到zip格式，</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200311151648233.png" srcset="/img/loading.gif" lazyload alt="image-20200311151648233"></p>
<p>直接改后缀解压，得到摩斯密码，解密是flag.zip的密码，输入后得到base64加密的flag。</p>
<p>解密即可。flag{Th1s_is_FlaG_you_aRE_rigHT}</p>
<h2 id="隐藏的信息"><a href="#隐藏的信息" class="headerlink" title="隐藏的信息"></a>隐藏的信息</h2><p>拿到一个残缺的二维码，看这个二维码很别扭，用Stegsolve.jar翻转了颜色之后，看上去舒服多了，然后补定位符，奈何手残，总是补不好，于是放弃，然后我再压缩包右击了一下7z解压，无意发现这个压缩包是假密码，拿到了一个wav文件，使用百度找了好多类似的题，用Audacity分析频谱发现开始和结束有问题，把音量调到最大，开始的部分还是听不到，但是最后可以听出是拨号音，（看过柯南，一下就猜出这是要猜电话号码），结合百度，才发现和DTFM有关。这里给出一篇参考文章：<a target="_blank" rel="noopener" href="https://hebin.me/2017/09/10/%E8%A5%BF%E6%99%AEctf-beyond/">https://hebin.me/2017/09/10/%E8%A5%BF%E6%99%AEctf-beyond/</a></p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200311153008620.png" srcset="/img/loading.gif" lazyload alt="image-20200311153008620"></p>
<p>然后可以得到一串数字187485618521，但是提交不对，感觉还是和那个二维码有关，</p>
<p>strings命令找到：<img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200311153154593.png" srcset="/img/loading.gif" lazyload alt="image-20200311153154593"></p>
<p>看来要base64加密,最后得出flag{MTg3NDg1NjE4NTIx}</p>
<h2 id="ez-mem-amp-usb"><a href="#ez-mem-amp-usb" class="headerlink" title="ez_mem&amp;usb"></a>ez_mem&amp;usb</h2><p>从来不刷杂项题，所以都是靠百度做，拿到一个数据pcap文件，分析流量，过滤http协议，找到上传的文件。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200311153716210.png" srcset="/img/loading.gif" lazyload alt="image-20200311153716210"></p>
<p>发现一个40M的数据包，那肯定传文件了，把文件dump出来，直接解压，得到一个vmem文件，百度一波，这是要内存取证，萌新参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/0x4D75/p/11161822.html">https://www.cnblogs.com/0x4D75/p/11161822.html</a></p>
<p>思路是，filescan+grep找到和flag字符匹配的文件，还真有一个flag.img，将flag.img dump出来，然后直接7z解压，需要密码，于是找到内存镜像中的cmd命令，有密码给出。</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@redhat</span><span class="hljs-symbol">:/mnt/hgfs/P/</span>高校战疫/misc/usb取证<span class="hljs-comment"># volatility -f data.vmem --profile=WinXPSP3x86 filescan | grep flag</span><br>Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br><span class="hljs-number">0x0000000001155f90</span>      <span class="hljs-number">1</span>      0 R--rwd \Device\HarddiskVolume1\Documents <span class="hljs-keyword">and</span> Settings\Administrator\flag.img<br><br>root<span class="hljs-variable">@redhat</span><span class="hljs-symbol">:/mnt/hgfs/P/</span>高校战疫/misc/usb取证<span class="hljs-comment"># volatility -f data.vmem --profile=WinXPSP3x86 dumpfiles -Q 0x1155f90 -D ./output</span><br>Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>DataSectionObject <span class="hljs-number">0x01155f90</span>   None   \Device\HarddiskVolume1\Documents <span class="hljs-keyword">and</span> Settings\Administrator\flag.img<br><br>root<span class="hljs-variable">@redhat</span><span class="hljs-symbol">:/mnt/hgfs/P/</span>高校战疫/misc/usb取证<span class="hljs-comment"># volatility -f data.vmem --profile=WinXPSP3x86 cmdscan</span><br>Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>**************************************************<br><span class="hljs-symbol">CommandProcess:</span> csrss.exe <span class="hljs-symbol">Pid:</span> <span class="hljs-number">464</span><br><span class="hljs-symbol">CommandHistory:</span> <span class="hljs-number">0x556bb8</span> <span class="hljs-symbol">Application:</span> cmd.exe <span class="hljs-symbol">Flags:</span> Allocated, Reset<br><span class="hljs-symbol">CommandCount:</span> <span class="hljs-number">2</span> <span class="hljs-symbol">LastAdded:</span> <span class="hljs-number">1</span> <span class="hljs-symbol">LastDisplayed:</span> <span class="hljs-number">1</span><br><span class="hljs-symbol">FirstCommand:</span> 0 <span class="hljs-symbol">CommandCountMax:</span> <span class="hljs-number">50</span><br><span class="hljs-symbol">ProcessHandle:</span> <span class="hljs-number">0x504</span><br>Cmd <span class="hljs-comment">#0 @ 0x3609ea0: passwd:weak_auth_top100</span><br>Cmd <span class="hljs-comment">#1 @ 0x5576d0: start wireshark</span><br>Cmd <span class="hljs-comment">#13 @ 0x9f009f: ??</span><br>Cmd <span class="hljs-comment">#41 @ 0x9f003f: ?\?????????</span><br><br></code></pre></td></tr></table></figure>

<p>压缩包里是一个usbdata，查了一下这个脚本，解密即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">usb_codes = &#123;<br>   <span class="hljs-number">0x04</span>:<span class="hljs-string">&quot;aA&quot;</span>, <span class="hljs-number">0x05</span>:<span class="hljs-string">&quot;bB&quot;</span>, <span class="hljs-number">0x06</span>:<span class="hljs-string">&quot;cC&quot;</span>, <span class="hljs-number">0x07</span>:<span class="hljs-string">&quot;dD&quot;</span>, <span class="hljs-number">0x08</span>:<span class="hljs-string">&quot;eE&quot;</span>, <span class="hljs-number">0x09</span>:<span class="hljs-string">&quot;fF&quot;</span>,<br>   <span class="hljs-number">0x0A</span>:<span class="hljs-string">&quot;gG&quot;</span>, <span class="hljs-number">0x0B</span>:<span class="hljs-string">&quot;hH&quot;</span>, <span class="hljs-number">0x0C</span>:<span class="hljs-string">&quot;iI&quot;</span>, <span class="hljs-number">0x0D</span>:<span class="hljs-string">&quot;jJ&quot;</span>, <span class="hljs-number">0x0E</span>:<span class="hljs-string">&quot;kK&quot;</span>, <span class="hljs-number">0x0F</span>:<span class="hljs-string">&quot;lL&quot;</span>,<br>   <span class="hljs-number">0x10</span>:<span class="hljs-string">&quot;mM&quot;</span>, <span class="hljs-number">0x11</span>:<span class="hljs-string">&quot;nN&quot;</span>, <span class="hljs-number">0x12</span>:<span class="hljs-string">&quot;oO&quot;</span>, <span class="hljs-number">0x13</span>:<span class="hljs-string">&quot;pP&quot;</span>, <span class="hljs-number">0x14</span>:<span class="hljs-string">&quot;qQ&quot;</span>, <span class="hljs-number">0x15</span>:<span class="hljs-string">&quot;rR&quot;</span>,<br>   <span class="hljs-number">0x16</span>:<span class="hljs-string">&quot;sS&quot;</span>, <span class="hljs-number">0x17</span>:<span class="hljs-string">&quot;tT&quot;</span>, <span class="hljs-number">0x18</span>:<span class="hljs-string">&quot;uU&quot;</span>, <span class="hljs-number">0x19</span>:<span class="hljs-string">&quot;vV&quot;</span>, <span class="hljs-number">0x1A</span>:<span class="hljs-string">&quot;wW&quot;</span>, <span class="hljs-number">0x1B</span>:<span class="hljs-string">&quot;xX&quot;</span>,<br>   <span class="hljs-number">0x1C</span>:<span class="hljs-string">&quot;yY&quot;</span>, <span class="hljs-number">0x1D</span>:<span class="hljs-string">&quot;zZ&quot;</span>, <span class="hljs-number">0x1E</span>:<span class="hljs-string">&quot;1!&quot;</span>, <span class="hljs-number">0x1F</span>:<span class="hljs-string">&quot;2@&quot;</span>, <span class="hljs-number">0x20</span>:<span class="hljs-string">&quot;3#&quot;</span>, <span class="hljs-number">0x21</span>:<span class="hljs-string">&quot;4$&quot;</span>,<br>   <span class="hljs-number">0x22</span>:<span class="hljs-string">&quot;5%&quot;</span>, <span class="hljs-number">0x23</span>:<span class="hljs-string">&quot;6^&quot;</span>, <span class="hljs-number">0x24</span>:<span class="hljs-string">&quot;7&amp;&quot;</span>, <span class="hljs-number">0x25</span>:<span class="hljs-string">&quot;8*&quot;</span>, <span class="hljs-number">0x26</span>:<span class="hljs-string">&quot;9(&quot;</span>, <span class="hljs-number">0x27</span>:<span class="hljs-string">&quot;0)&quot;</span>,<br>   <span class="hljs-number">0x2C</span>:<span class="hljs-string">&quot;  &quot;</span>, <span class="hljs-number">0x2D</span>:<span class="hljs-string">&quot;-_&quot;</span>, <span class="hljs-number">0x2E</span>:<span class="hljs-string">&quot;=+&quot;</span>, <span class="hljs-number">0x2F</span>:<span class="hljs-string">&quot;[&#123;&quot;</span>, <span class="hljs-number">0x30</span>:<span class="hljs-string">&quot;]&#125;&quot;</span>,  <span class="hljs-number">0x32</span>:<span class="hljs-string">&quot;#~&quot;</span>,<br>   <span class="hljs-number">0x33</span>:<span class="hljs-string">&quot;;:&quot;</span>, <span class="hljs-number">0x34</span>:<span class="hljs-string">&quot;&#x27;\&quot;&quot;</span>,  <span class="hljs-number">0x36</span>:<span class="hljs-string">&quot;,&lt;&quot;</span>,  <span class="hljs-number">0x37</span>:<span class="hljs-string">&quot;.&gt;&quot;</span>, <span class="hljs-number">0x4f</span>:<span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-number">0x50</span>:<span class="hljs-string">&quot;&lt;&quot;</span><br>   &#125;<br><br>key = [<span class="hljs-number">0x09</span>,<span class="hljs-number">0x0F</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x2F</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x1F</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x25</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x1F</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x1E</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x30</span>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key)):<br>    flag += usb_codes[key[i]][<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>flag{69200835784ec3ed8d2a64e73fe913c0}</p>
<h2 id="武汉加油"><a href="#武汉加油" class="headerlink" title="武汉加油"></a>武汉加油</h2><p>010editor打开图片，这可真是个好东西啊，两种不同的文件格式还分颜色。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319111152938.png" srcset="/img/loading.gif" lazyload alt="image-20200319111152938"></p>
<p>直接改后缀rar解压，</p>
<p>然后使用一个工具爆破出隐藏的flag.txt文件。</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sqf">将<span class="hljs-built_in">flag</span>.txt文件隐藏到<span class="hljs-built_in">flag</span>.jpg中：<br>steghide embed -cf <span class="hljs-built_in">flag</span>.jpg -ef <span class="hljs-built_in">flag</span>.txt -p <span class="hljs-number">123456</span><br><br>从<span class="hljs-built_in">flag</span>.jpg解出<span class="hljs-built_in">flag</span>.txt:<br>steghide extract -sf <span class="hljs-built_in">flag</span>.jpg -p <span class="hljs-number">123456</span><br><br></code></pre></td></tr></table></figure>

<p>shell脚本爆破密码：</p>
<p>…..没成功，算了，不贴了。。</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="天津垓"><a href="#天津垓" class="headerlink" title="天津垓"></a>天津垓</h2><p>上来先运行程序，提示缺少cygwin1.dll文件，下载了之后运行还是报错，算了吧，静态分析看看。</p>
<p>找到了一个f函数，代码很简单，就一些简单的运算操作。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315160945833.png" srcset="/img/loading.gif" lazyload alt="image-20200315160945833"></p>
<p>感觉有戏，直接写脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">s1 = [<span class="hljs-number">0x52</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x21</span>]<br>s2 = [<span class="hljs-number">17</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">42</span>, <span class="hljs-number">59</span>, <span class="hljs-number">47</span>, <span class="hljs-number">3</span>, <span class="hljs-number">47</span>, <span class="hljs-number">4</span>, <span class="hljs-number">16</span>, <span class="hljs-number">72</span>, <span class="hljs-number">62</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">16</span>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>        <span class="hljs-keyword">if</span> s2[i] == (~(j &amp; s1[i % <span class="hljs-number">14</span>])) &amp; (j | s1[i % <span class="hljs-number">14</span>]):<br>            flag += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>脚本跑出来是<code>Caucasus@s_ability</code>，提交也不对，我把这个函数出现的字符串都搜了一遍，知道了这是个假面骑士……没看过，我还把跑出来的字符串发给一个假面迷，我真是够了。看了看别的函数，发现有反调试特征：</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315161644169.png" srcset="/img/loading.gif" lazyload alt="image-20200315161644169"></p>
<p>那肯定要动态调试的啊，一想又运行不了。我把函数都看一遍看看有什么信息。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315162052676.png" srcset="/img/loading.gif" lazyload alt="image-20200315162052676"></p>
<p>发现这里的Str和f函数中的Str是一个，分析了一下这个函数，是一段SMC(自修改代码)进行动态解密的。</p>
<p>使用IDAPython：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&quot;Caucasus@s_ability&quot;</span><br>start = <span class="hljs-number">0x10040164d</span><br>end = start + <span class="hljs-number">1045</span><br>j = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start, end):<br>    ida_bytes.patch_byte(i, ida_bytes.get_byte(i)^ <span class="hljs-built_in">ord</span>(flag[j % <span class="hljs-number">18</span>]))<br>    j += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315162525217.png" srcset="/img/loading.gif" lazyload alt="image-20200315162525217"></p>
<p>也不是很复杂。。。。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs py">s = [<span class="hljs-number">2007666</span>,<span class="hljs-number">2125764</span>,<span class="hljs-number">1909251</span>,<span class="hljs-number">2027349</span>,<span class="hljs-number">2421009</span>,<span class="hljs-number">1653372</span>,<span class="hljs-number">2047032</span>,<span class="hljs-number">2184813</span>,<span class="hljs-number">2302911</span>,<span class="hljs-number">2263545</span>,<span class="hljs-number">1909251</span>,<span class="hljs-number">2165130</span>,<span class="hljs-number">1968300</span>,<span class="hljs-number">2243862</span>,<span class="hljs-number">2066715</span>,<span class="hljs-number">2322594</span>,<span class="hljs-number">1987983</span>,<span class="hljs-number">2243862</span>,<span class="hljs-number">1869885</span>,<span class="hljs-number">2066715</span>,<span class="hljs-number">2263545</span>,<span class="hljs-number">1869885</span>,<span class="hljs-number">964467</span>,<span class="hljs-number">944784</span>,<span class="hljs-number">944784</span>,<span class="hljs-number">944784</span>,<span class="hljs-number">728271</span>,<span class="hljs-number">1869885</span>,<span class="hljs-number">2263545</span>,<span class="hljs-number">2283228</span>,<span class="hljs-number">2243862</span>,<span class="hljs-number">2184813</span>,<span class="hljs-number">2165130</span>,<span class="hljs-number">2027349</span>,<span class="hljs-number">1987983</span>,<span class="hljs-number">2243862</span>,<span class="hljs-number">1869885</span>,<span class="hljs-number">2283228</span>,<span class="hljs-number">2047032</span>,<span class="hljs-number">1909251</span>,<span class="hljs-number">2165130</span>,<span class="hljs-number">1869885</span>,<span class="hljs-number">2401326</span>,<span class="hljs-number">1987983</span>,<span class="hljs-number">2243862</span>,<span class="hljs-number">2184813</span>,<span class="hljs-number">885735</span>,<span class="hljs-number">2184813</span>,<span class="hljs-number">2165130</span>,<span class="hljs-number">1987983</span>,<span class="hljs-number">2460375</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(s))<br>v61 = <span class="hljs-number">19683</span><br>v62 = <span class="hljs-number">0x8000000B</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">51</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">255</span>):<br>        <span class="hljs-keyword">if</span> s[i] == v61 * j % v62:<br>            flag+=<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>flag{Thousandriver_is_1000%_stronger_than_zero-one}</p>
<h2 id="cycle-graph"><a href="#cycle-graph" class="headerlink" title="cycle_graph"></a>cycle_graph</h2><p>描述是图算法，估计凉了，数据结构菜的一笔。</p>
<p>找到关键函数：</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315163844983.png" srcset="/img/loading.gif" lazyload alt="image-20200315163844983"></p>
<p>这里是对v1进行初始化，假设v1是个二维数组，每组有三个数据，根据代码可分析出有32组。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315164605229.png" srcset="/img/loading.gif" lazyload alt="image-20200315164605229"></p>
<p>这里就是主要算法。</p>
<p>然后最后判断flag：</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315195856725.png" srcset="/img/loading.gif" lazyload alt="image-20200315195856725"></p>
<p>刚开始没注意v7的限制，直接写的脚本跑，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> string<br><br>arr_1 = [<span class="hljs-number">0x00000034</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x0000002C</span>, <span class="hljs-number">0x0000002A</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x0000002A</span>, <span class="hljs-number">0x0000002F</span>, <span class="hljs-number">0x0000002A</span>, <span class="hljs-number">0x00000033</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000032</span>, <span class="hljs-number">0x00000032</span>, <span class="hljs-number">0x00000032</span>, <span class="hljs-number">0x00000030</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000032</span>, <span class="hljs-number">0x0000002B</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x0000002E</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x00000032</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x0000002D</span>, <span class="hljs-number">0x00000030</span>, <span class="hljs-number">0x00000031</span>, <span class="hljs-number">0x0000002F</span>, <span class="hljs-number">0x00000033</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(arr_1))<br>arr_2 = [<span class="hljs-number">0x0000001F</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000012</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x0000001A</span>, <span class="hljs-number">0x0000000D</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x0000000A</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x00000015</span>, <span class="hljs-number">0x0000000E</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x0000000E</span>, <span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x0000000C</span>, <span class="hljs-number">0x0000001C</span>, <span class="hljs-number">0x0000000F</span>, <span class="hljs-number">0x0000000F</span>, <span class="hljs-number">0x00000002</span>, <span class="hljs-number">0x00000010</span>, <span class="hljs-number">0x00000017</span>, <span class="hljs-number">0x0000001E</span>, <span class="hljs-number">0x00000017</span>, <span class="hljs-number">0x00000013</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000016</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(arr_2))<br>arr_3 = [<span class="hljs-number">0x00000005</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x00000017</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000013</span>, <span class="hljs-number">0x0000001F</span>, <span class="hljs-number">0x00000017</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x0000000D</span>, <span class="hljs-number">0x0000000C</span>, <span class="hljs-number">0x0000001D</span>, <span class="hljs-number">0x0000000A</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x00000018</span>, <span class="hljs-number">0x00000019</span>, <span class="hljs-number">0x00000009</span>, <span class="hljs-number">0x0000001A</span>, <span class="hljs-number">0x00000003</span>, <span class="hljs-number">0x00000016</span>, <span class="hljs-number">0x00000006</span>, <span class="hljs-number">0x00000011</span>, <span class="hljs-number">0x0000000D</span>, <span class="hljs-number">0x00000007</span>, <span class="hljs-number">0x0000000F</span>, <span class="hljs-number">0x00000014</span>, <span class="hljs-number">0x00000001</span>, <span class="hljs-number">0x00000010</span>, <span class="hljs-number">0x00000004</span>, <span class="hljs-number">0x0000000B</span>]<br><br>v1 = [[<span class="hljs-number">0</span>] * <span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">31</span>):<br>    v1[i][<span class="hljs-number">0</span>] = arr_1[i]<br>    v1[i][<span class="hljs-number">1</span>] = arr_2[i+<span class="hljs-number">1</span>]<br>    v1[i][<span class="hljs-number">2</span>] = arr_3[i+<span class="hljs-number">1</span>]<br><br><span class="hljs-built_in">print</span>(v1)<br><br>str1 = string.printable<br><span class="hljs-built_in">print</span>(str1)<br><br>v5 = <span class="hljs-number">48</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>ii = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> str1:<br>        <span class="hljs-keyword">if</span> v1[ii][<span class="hljs-number">0</span>] + v5 == <span class="hljs-built_in">ord</span>(j):<br>            flag += j<br>            ii = v1[ii][<span class="hljs-number">1</span>]<br>            v5 = <span class="hljs-built_in">ord</span>(j)<br>            <span class="hljs-built_in">print</span>(j)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">elif</span> v5 - v1[ii][<span class="hljs-number">0</span>] == <span class="hljs-built_in">ord</span>(j):<br>            flag += j<br>            ii = v1[ii][<span class="hljs-number">2</span>]<br>            v5 = <span class="hljs-built_in">ord</span>(j)<br>            <span class="hljs-built_in">print</span>(j)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>跑出来<code>d8b0bae8jh52db/2</code>,提交当然不对，后来看到了v7的限制。为什么v7会出现差异呢？ 因为有时候加v5和减v5都满足，不知道走哪条路径。估计得用某个算法解，比完赛再学一下算法，所以我手动正着加倒着，硬是给写出来了。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315170104295.png" srcset="/img/loading.gif" lazyload alt="image-20200315170104295"></p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200315170118029.png" srcset="/img/loading.gif" lazyload alt="image-20200315170118029"></p>
<p>满满的菜啊…….</p>
<p>此处可用广度优先搜索算法，算法学习具体参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/raphealguo/article/details/7523411">https://blog.csdn.net/raphealguo/article/details/7523411</a></p>
<h2 id="easyparser"><a href="#easyparser" class="headerlink" title="easyparser"></a>easyparser</h2><p>这个题，我可是特别肝的，知道是虚拟机，但是我也没遇到过这种题，直接动态调试，我一步一步跟出来的程序逻辑，还好不是特别复杂，也就调了6个小时左右吧。。。。先给出解密脚本，然后再学习一下正确的解法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">s = [<span class="hljs-number">144</span>, <span class="hljs-number">332</span>, <span class="hljs-number">28</span>, <span class="hljs-number">240</span>, <span class="hljs-number">132</span>, <span class="hljs-number">60</span>, <span class="hljs-number">24</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>, <span class="hljs-number">240</span>, <span class="hljs-number">208</span>, <span class="hljs-number">88</span>, <span class="hljs-number">44</span>, <span class="hljs-number">8</span>, <span class="hljs-number">52</span>, <span class="hljs-number">240</span>, <span class="hljs-number">276</span>, <span class="hljs-number">240</span>, <span class="hljs-number">128</span>, <span class="hljs-number">44</span>, <span class="hljs-number">40</span>, <span class="hljs-number">52</span>, <span class="hljs-number">8</span>, <span class="hljs-number">240</span>, <span class="hljs-number">144</span>, <span class="hljs-number">68</span>, <span class="hljs-number">48</span>, <span class="hljs-number">80</span>, <span class="hljs-number">92</span>, <span class="hljs-number">44</span>, <span class="hljs-number">264</span>, <span class="hljs-number">240</span>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x20</span>):<br>    flag += <span class="hljs-built_in">chr</span>((s[i] &gt;&gt; <span class="hljs-number">2</span>) ^ <span class="hljs-number">0x63</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag&#123;%s&#125;&quot;</span> % flag)<br></code></pre></td></tr></table></figure>

<p>flag{G0d_Bless_Wuhan_&amp;<em>China_Growth!</em>}</p>
<h2 id="fxck！"><a href="#fxck！" class="headerlink" title="fxck！"></a>fxck！</h2><p>太累了，所以这道题随便看了一下，看到base58特征，直接解码，发现不对，一想其他题都不简单，这个应该也不会这么简单吧，所以就没考虑换表。比完赛看了看，还真是换表解密，我哭了。。。。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200316152415784.png" srcset="/img/loading.gif" lazyload alt="image-20200316152415784"></p>
<p>这段是求余，我调了一下，发现不是直接把输入base58加密，还加了点东西，说实话，仔细分析，我没看懂这段伪代码，求得余数和我跑程序求得不一样，自闭了。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200316152611658.png" srcset="/img/loading.gif" lazyload alt="image-20200316152611658"></p>
<p>换表和加密，不难。</p>
<p>然后用了brainfuck代码，第一次遇见，根本不知道是什么东西，但是最后的比较字符串可以直接动调dump出来。因为是复现，也简单学习了一下这个加密。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200316152754240.png" srcset="/img/loading.gif" lazyload alt="image-20200316152754240"></p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200316152823755.png" srcset="/img/loading.gif" lazyload alt="image-20200316152823755"></p>
<p>注释中给出了这个加密的运算符。</p>
<p>既然又碰到了base58，就熟悉一下吧，go语言写脚本，参考:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45828877/article/details/103997621">https://blog.csdn.net/qq_45828877/article/details/103997621</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>	<span class="hljs-string">&quot;bytes&quot;</span><br>	<span class="hljs-string">&quot;fmt&quot;</span><br>	<span class="hljs-string">&quot;math/big&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> base58_table []<span class="hljs-keyword">byte</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(input []<span class="hljs-keyword">byte</span>)</span></span> &#123;<br>	bInt := big.NewInt(<span class="hljs-number">0</span>).SetBytes(input)<br>	fmt.Printf(<span class="hljs-string">&quot;输入字节的16进制表达:%x\n&quot;</span>, bInt)<br>	base := big.NewInt(<span class="hljs-number">58</span>)<br>	zero := big.NewInt(<span class="hljs-number">0</span>)<br>	mod := &amp;big.Int&#123;&#125;<br>	<span class="hljs-keyword">var</span> result []<span class="hljs-keyword">byte</span><br>	<span class="hljs-keyword">for</span> bInt.Cmp(zero) != <span class="hljs-number">0</span> &#123;<br>		bInt.DivMod(bInt, base, mod)<br>		fmt.Printf(<span class="hljs-string">&quot;%x\n&quot;</span>, mod)<br>		result = <span class="hljs-built_in">append</span>(result, base58_table[mod.Int64()])<br>	&#125;<br>	ReverseByte(result)<br>	fmt.Printf(<span class="hljs-string">&quot;base58加密结果:%s\n&quot;</span>, result)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Decrypt</span><span class="hljs-params">(input []<span class="hljs-keyword">byte</span>)</span></span> &#123;<br>	result := big.NewInt(<span class="hljs-number">0</span>)<br>	<span class="hljs-keyword">for</span> _, b := <span class="hljs-keyword">range</span> input &#123;<br>		index := bytes.IndexByte(base58_table, b)<br>		result.Mul(result, big.NewInt(<span class="hljs-number">58</span>))<br>		result.Add(result, big.NewInt(<span class="hljs-keyword">int64</span>(index)))<br>	&#125;<br>	decodeByte := result.Bytes()<br>	<span class="hljs-keyword">if</span> input[<span class="hljs-number">0</span>] == base58_table[<span class="hljs-number">0</span>] &#123;<br>		decodeByte = <span class="hljs-built_in">append</span>([]<span class="hljs-keyword">byte</span>&#123;<span class="hljs-number">0x00</span>&#125;, decodeByte...)<br>	&#125;<br>	fmt.Println(decodeByte)<br>	fmt.Printf(<span class="hljs-string">&quot;base58解密结果:%s&quot;</span>, decodeByte)<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ReverseByte</span><span class="hljs-params">(input []<span class="hljs-keyword">byte</span>)</span></span> &#123;<br>	<span class="hljs-keyword">for</span> i, j := <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(input)<span class="hljs-number">-1</span>; i &lt; j; i, j = i+<span class="hljs-number">1</span>, j<span class="hljs-number">-1</span> &#123;<br>		input[i], input[j] = input[j], input[i]<br>	&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	base58_table = []<span class="hljs-keyword">byte</span>(<span class="hljs-string">&quot;ABCDEFGHJKLMNPQRSTUVWXYZ123456789abcdefghijkmnopqrstuvwxyz&quot;</span>)<br>	Encrypt([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">&quot;\x06&quot;</span> + <span class="hljs-string">&quot;flag&#123;63510cf7-2b80-45e1-a186-21234897e5cd&#125;&quot;</span>))<br>	Decrypt([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">&quot;4VyhuTqRfYFnQ85Bcw5XcDr3ScNBjf5CzwUdWKVM7SSVqBrkvYGt7SSUJe&quot;</span>))<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200316153024371.png" srcset="/img/loading.gif" lazyload alt="image-20200316153024371"></p>
<p>跑出来，发现第一个字节是个<code>\x6</code>……..</p>
<h2 id="clock"><a href="#clock" class="headerlink" title="clock"></a>clock</h2><p>比赛的时候分析出了源码，但是不知道是什么加密，无从下手。</p>
<p>后得知是LFSR(线性反馈移位寄存器)，可参考：</p>
<p>LFSR具体参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/181811">https://www.anquanke.com/post/id/181811</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3682">https://xz.aliyun.com/t/3682</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33920501">https://zhuanlan.zhihu.com/p/33920501</a></p>
<p>writeup和脚本参考:</p>
<p><a target="_blank" rel="noopener" href="http://ctf.njupt.edu.cn/382.html#clock">http://ctf.njupt.edu.cn/382.html#clock</a></p>
<p>贴出逆向的源码(python3)和爆破脚本(go语言)吧。</p>
<p>程序主要源码：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs py">v4 = xxx<br>v3 = xxx<br>v2 = xxx<br>result = []<br><span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x100000</span>):<br>    v5 = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):<br>        v7 = v4 &amp; <span class="hljs-number">0x17FA06</span><br>        i = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> v7:<br>            i ^= v7 &amp; <span class="hljs-number">1</span><br>            v7 &gt;&gt;= <span class="hljs-number">1</span><br>        v4 = (i ^ <span class="hljs-number">2</span> * v4) &amp; <span class="hljs-number">0x1FFFFF</span><br>        v9 = v3 &amp; <span class="hljs-number">0x2A9A0D</span><br>        j = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> v9:<br>            j ^= v9 &amp; <span class="hljs-number">1</span><br>            v9 &gt;&gt;= <span class="hljs-number">1</span><br>        v3 = (j ^ <span class="hljs-number">2</span> * v3) &amp; <span class="hljs-number">0x3FFFFF</span><br>        v11 = v2 &amp; <span class="hljs-number">0x5E5E6A</span><br>        k = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> v11:<br>            k ^= v11 &amp; <span class="hljs-number">1</span><br>            v11 &gt;&gt;= <span class="hljs-number">1</span><br>        v2 = (k ^ <span class="hljs-number">2</span> * v2) &amp; <span class="hljs-number">0x7FFFFF</span><br>        v13 = <span class="hljs-number">2</span> * v5<br>        v14 = v3<br>        <span class="hljs-keyword">if</span> v4 &amp; <span class="hljs-number">1</span>:<br>            v14 = v2<br>        v5 = v14 &amp; <span class="hljs-number">1</span> ^ v13<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(v5))<br>    result.append(v5)<br><span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>

<p>爆破脚本：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">lfsr</span><span class="hljs-params">(R, mask1, mask2 <span class="hljs-keyword">int64</span>, result *[100]<span class="hljs-keyword">uint8</span>, <span class="hljs-built_in">len</span> <span class="hljs-keyword">int</span>)</span></span> &#123;<br>	<span class="hljs-keyword">for</span> x := <span class="hljs-number">0</span>; x &lt; <span class="hljs-built_in">len</span>; x++ &#123;<br>		<span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">8</span>; j++ &#123;<br>			i := R &amp; mask1<br>			lastbit := <span class="hljs-keyword">uint8</span>(<span class="hljs-number">0</span>)<br>			<span class="hljs-keyword">for</span> i != <span class="hljs-number">0</span> &#123;<br>				lastbit ^= <span class="hljs-keyword">uint8</span>(i &amp; <span class="hljs-number">1</span>)<br>				i &gt;&gt;= <span class="hljs-number">1</span><br>			&#125;<br>			R = (R&lt;&lt;<span class="hljs-number">1</span> ^ <span class="hljs-keyword">int64</span>(lastbit)) &amp; mask2<br>			result[x] = result[x]&lt;&lt;<span class="hljs-number">1</span> ^ lastbit<br>		&#125;<br>	&#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> output = [<span class="hljs-number">100</span>]<span class="hljs-keyword">uint8</span>&#123;<span class="hljs-number">95</span>, <span class="hljs-number">83</span>, <span class="hljs-number">107</span>, <span class="hljs-number">255</span>, <span class="hljs-number">209</span>, <span class="hljs-number">96</span>, <span class="hljs-number">188</span>, <span class="hljs-number">166</span>, <span class="hljs-number">230</span>, <span class="hljs-number">219</span>, <span class="hljs-number">223</span>, <span class="hljs-number">72</span>, <span class="hljs-number">150</span>, <span class="hljs-number">155</span>, <span class="hljs-number">169</span>,<br>	<span class="hljs-number">138</span>, <span class="hljs-number">126</span>, <span class="hljs-number">0</span>, <span class="hljs-number">91</span>, <span class="hljs-number">20</span>, <span class="hljs-number">19</span>, <span class="hljs-number">109</span>, <span class="hljs-number">82</span>, <span class="hljs-number">12</span>, <span class="hljs-number">249</span>, <span class="hljs-number">91</span>, <span class="hljs-number">39</span>, <span class="hljs-number">107</span>, <span class="hljs-number">104</span>, <span class="hljs-number">55</span>, <span class="hljs-number">207</span>,<br>	<span class="hljs-number">65</span>, <span class="hljs-number">155</span>, <span class="hljs-number">197</span>, <span class="hljs-number">204</span>, <span class="hljs-number">81</span>, <span class="hljs-number">76</span>, <span class="hljs-number">22</span>, <span class="hljs-number">83</span>, <span class="hljs-number">208</span>, <span class="hljs-number">215</span>, <span class="hljs-number">13</span>, <span class="hljs-number">254</span>, <span class="hljs-number">14</span>, <span class="hljs-number">43</span>, <span class="hljs-number">87</span>, <span class="hljs-number">29</span>,<br>	<span class="hljs-number">42</span>, <span class="hljs-number">161</span>, <span class="hljs-number">92</span>, <span class="hljs-number">2</span>, <span class="hljs-number">109</span>, <span class="hljs-number">110</span>, <span class="hljs-number">232</span>, <span class="hljs-number">201</span>, <span class="hljs-number">147</span>, <span class="hljs-number">19</span>, <span class="hljs-number">53</span>, <span class="hljs-number">216</span>, <span class="hljs-number">82</span>, <span class="hljs-number">144</span>, <span class="hljs-number">169</span>,<br>	<span class="hljs-number">34</span>, <span class="hljs-number">193</span>, <span class="hljs-number">106</span>, <span class="hljs-number">0</span>, <span class="hljs-number">253</span>, <span class="hljs-number">224</span>, <span class="hljs-number">7</span>, <span class="hljs-number">46</span>, <span class="hljs-number">24</span>, <span class="hljs-number">16</span>, <span class="hljs-number">226</span>, <span class="hljs-number">127</span>, <span class="hljs-number">164</span>, <span class="hljs-number">162</span>, <span class="hljs-number">54</span>, <span class="hljs-number">98</span>,<br>	<span class="hljs-number">144</span>, <span class="hljs-number">141</span>, <span class="hljs-number">182</span>, <span class="hljs-number">174</span>, <span class="hljs-number">252</span>, <span class="hljs-number">64</span>, <span class="hljs-number">130</span>, <span class="hljs-number">19</span>, <span class="hljs-number">163</span>, <span class="hljs-number">242</span>, <span class="hljs-number">176</span>, <span class="hljs-number">78</span>, <span class="hljs-number">79</span>, <span class="hljs-number">3</span>, <span class="hljs-number">19</span>, <span class="hljs-number">11</span>,<br>	<span class="hljs-number">160</span>, <span class="hljs-number">121</span>, <span class="hljs-number">149</span>, <span class="hljs-number">44</span>, <span class="hljs-number">53</span>, <span class="hljs-number">17</span>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">equalNumSum</span><span class="hljs-params">(rResult *[100]<span class="hljs-keyword">uint8</span>, output [100]<span class="hljs-keyword">uint8</span>, <span class="hljs-built_in">len</span> <span class="hljs-keyword">int</span>)</span> <span class="hljs-params">(sum <span class="hljs-keyword">int</span>)</span></span> &#123;<br>	sum = <span class="hljs-number">0</span><br>	<span class="hljs-keyword">for</span> x := <span class="hljs-number">0</span>; x &lt; <span class="hljs-built_in">len</span>; x++ &#123;<br>		<span class="hljs-keyword">for</span> j := <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">8</span>; j++ &#123;<br>			<span class="hljs-keyword">if</span> (rResult[x] &amp; <span class="hljs-number">1</span>) == (output[x] &amp; <span class="hljs-number">1</span>) &#123;<br>				sum++<br>			&#125;<br>			rResult[x] &gt;&gt;= <span class="hljs-number">1</span><br>			output[x] &gt;&gt;= <span class="hljs-number">1</span><br>		&#125;<br>	&#125;<br>	<span class="hljs-comment">//fmt.Println(sum)</span><br>	<span class="hljs-keyword">return</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">guessR</span><span class="hljs-params">(mask1, mask2 <span class="hljs-keyword">int64</span>, restrict <span class="hljs-keyword">int</span>)</span> <span class="hljs-title">int64</span></span> &#123;<br>	<span class="hljs-keyword">var</span> result = [<span class="hljs-number">100</span>]<span class="hljs-keyword">uint8</span>&#123;&#125;<br>	<span class="hljs-built_in">len</span> := <span class="hljs-number">100</span><br>	maxLen := <span class="hljs-keyword">int64</span>(<span class="hljs-number">1</span> &lt;&lt; restrict)<br>	cmpMax := <span class="hljs-number">0</span><br>	rr := <span class="hljs-keyword">int64</span>(<span class="hljs-number">0</span>)<br>	<span class="hljs-keyword">for</span> r := <span class="hljs-keyword">int64</span>(<span class="hljs-number">0</span>); r &lt; maxLen; r++ &#123;<br>		lfsr(r, mask1, mask2, &amp;result, <span class="hljs-built_in">len</span>)<br>		equalNumSum := equalNumSum(&amp;result, output, <span class="hljs-built_in">len</span>)<br>		<span class="hljs-keyword">if</span> equalNumSum &gt; cmpMax &#123;<br>			cmpMax = equalNumSum<br>			rr = r<br>			fmt.Println(rr, cmpMax)<br>		&#125;<br>	&#125;<br>	fmt.Println(rr, cmpMax)<br>	<span class="hljs-keyword">return</span> rr<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">brute_r1</span><span class="hljs-params">(r2, r3 [100]<span class="hljs-keyword">uint8</span>)</span> <span class="hljs-title">int64</span></span> &#123;<br>	<span class="hljs-keyword">var</span> r1 [<span class="hljs-number">100</span>]<span class="hljs-keyword">uint8</span><br>	<span class="hljs-built_in">len</span> := <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">21</span><br>	<span class="hljs-keyword">var</span> c <span class="hljs-keyword">uint8</span><br>	<span class="hljs-keyword">for</span> r := <span class="hljs-number">0</span>; r &lt; <span class="hljs-built_in">len</span>; r++ &#123;<br>		lfsr(<span class="hljs-keyword">int64</span>(r), <span class="hljs-number">0x17fa06</span>, <span class="hljs-number">0x1fffff</span>, &amp;r1, <span class="hljs-number">100</span>)<br>		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++ &#123;<br>			<span class="hljs-keyword">for</span> k := <span class="hljs-number">7</span>; k &gt;= <span class="hljs-number">0</span>; k-- &#123;<br>				s1 := (r1[i] &gt;&gt; k &amp; <span class="hljs-number">1</span>)<br>				s2 := (r2[i] &gt;&gt; k &amp; <span class="hljs-number">1</span>)<br>				s3 := (r3[i] &gt;&gt; k &amp; <span class="hljs-number">1</span>)<br>				z := s2<br>				<span class="hljs-keyword">if</span> s1 == <span class="hljs-number">1</span> &#123;<br>					z = s3<br>				&#125;<br>				c = c&lt;&lt;<span class="hljs-number">1</span> ^ z<br>			&#125;<br>			<span class="hljs-keyword">if</span> c != output[i] &#123;<br>				<span class="hljs-keyword">break</span><br>			&#125;<br>			<span class="hljs-keyword">if</span> i == <span class="hljs-number">99</span> &#123;<br>				<span class="hljs-keyword">return</span> <span class="hljs-keyword">int64</span>(r)<br>			&#125;<br>		&#125;<br>		fmt.Println(r)<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>	<span class="hljs-keyword">var</span> r2Result = [<span class="hljs-number">100</span>]<span class="hljs-keyword">uint8</span>&#123;&#125;<br>	<span class="hljs-keyword">var</span> r3Result = [<span class="hljs-number">100</span>]<span class="hljs-keyword">uint8</span>&#123;&#125;<br>	<span class="hljs-comment">//r2 := guessR(0x2a9a0d, 0x3fffff, 22)   //3324079</span><br>	<span class="hljs-comment">//r3 := guessR(0x5E5E6A, 0x7fffff, 23)	 //4958299</span><br>	r2 := <span class="hljs-number">3324079</span><br>	r3 := <span class="hljs-number">4958299</span><br>	lfsr(<span class="hljs-number">3324079</span>, <span class="hljs-number">0x2a9a0d</span>, <span class="hljs-number">0x3fffff</span>, &amp;r2Result, <span class="hljs-number">100</span>)<br>	lfsr(<span class="hljs-number">4958299</span>, <span class="hljs-number">0x5E5E6A</span>, <span class="hljs-number">0x7fffff</span>, &amp;r3Result, <span class="hljs-number">100</span>)<br>	fmt.Println(r2Result)<br>	fmt.Println(r3Result)<br>	r1 := brute_r1(r2Result, r3Result)<br>	fmt.Printf(<span class="hljs-string">&quot;flag&#123;%x%x%x&#125;&quot;</span>, r1, r2, r3)<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h1 id="Mobile"><a href="#Mobile" class="headerlink" title="Mobile"></a>Mobile</h1><h2 id="GetFlag"><a href="#GetFlag" class="headerlink" title="GetFlag"></a>GetFlag</h2><p>比赛的时候觉得快出了，但是不会通信就很难受，复现一遍吧。</p>
<p>扔到JEB里看看。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319114048514.png" srcset="/img/loading.gif" lazyload alt="image-20200319114048514"></p>
<p>往一个文件里写了flag，这样的方式创建的文件会在应用的私有目录下。我们安装软件到手机上，使用adb shell查看。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319120728403.png" srcset="/img/loading.gif" lazyload alt="image-20200319120728403"></p>
<p>服务端监听8080端口。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319114813854.png" srcset="/img/loading.gif" lazyload alt="image-20200319114813854"></p>
<p>通过输入流得的传给它的数据。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319120127116.png" srcset="/img/loading.gif" lazyload alt="image-20200319120127116"></p>
<p>还有接收数据的方法。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319120203664.png" srcset="/img/loading.gif" lazyload alt="image-20200319120203664"></p>
<p>通过输出流返回一个随机数。然后对输入的数据进行了一些操作。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319120307536.png" srcset="/img/loading.gif" lazyload alt="image-20200319120307536"></p>
<p>主要就是checkpayload方法。</p>
<p><img src="/2020/03/11/%E9%AB%98%E6%A0%A1%E6%88%98%E5%BD%B9CTF%E9%83%A8%E5%88%86writeup/image-20200319120349230.png" srcset="/img/loading.gif" lazyload alt="image-20200319120349230"></p>
<p>验证mssage和check，check是随机数作为密钥的HmacSha1加密。</p>
<p>验证通过即可执行wget message。</p>
<p>没有环境了，搭了几个小时，还是没有成功。。。。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF%E8%B5%9B%E9%A2%98writeup/">CTF赛题writeup</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CTF/">CTF</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/03/14/Android%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%A0%B4%E8%A7%A3%E6%8A%80%E6%9C%AF/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Android软件的破解技术</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/03/10/%E4%BA%8C%E5%8F%89%E6%A0%91/">
                        <span class="hidden-mobile">二叉树</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.3/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.1/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js" ></script>



  <script  src="/js/local-search.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
